<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>El Profeta Rebelde - Hogwarts Ori√≥n</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Special+Elite&display=swap');

        /* --- ESTILOS GENERALES (PAPEL ANTIGUO) --- */
        body {
            background: #1a150f url('https://www.transparenttextures.com/patterns/paper-fibers.png');
            margin: 0; padding: 20px; display: flex; justify-content: center;
            font-family: 'Special Elite', cursive; color: #2c1e11;
        }

        .container {
            background: #f4e4bc; width: 95%; max-width: 900px; padding: 40px;
            box-shadow: 0 0 50px rgba(0,0,0,0.5); border: 2px solid #d2b48c;
            min-height: 100vh; position: relative;
        }

        header { text-align: center; border-bottom: 5px double #2c1e11; margin-bottom: 20px; }
        header h1 { font-family: 'Cinzel', serif; font-size: clamp(30px, 8vw, 60px); margin: 10px 0; }

        /* --- NAVEGACI√ìN --- */
        .magic-nav { display: flex; justify-content: center; gap: 10px; margin-bottom: 30px; }
        .nav-btn {
            background: #2c1e11; color: #d4af37; border: 2px solid #d4af37;
            padding: 10px 20px; font-family: 'Cinzel'; cursor: pointer; transition: 0.3s;
        }
        .nav-btn.active { background: #d4af37; color: #1a150f; }

        .content-section { display: none; }
        .content-section.active { display: block; animation: fadeIn 0.5s; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        /* --- ESTILOS PERI√ìDICO --- */
        .noticia { background: rgba(0,0,0,0.03); padding: 20px; margin-bottom: 20px; border: 1px dashed #2c1e11; }
        .casa-tag { padding: 3px 8px; color: white; font-size: 12px; font-weight: bold; border-radius: 3px; }
        .Slytherin { background: #1a472a; } .Gryffindor { background: #740001; }
        .Hufflepuff { background: #ecb939; color: black; } .Ravenclaw { background: #0e1a40; }
        
        .formulario { background: #2c1e11; color: #f4e4bc; padding: 25px; border-radius: 10px; margin-top: 40px; }
        input, textarea, select { width: 100%; padding: 10px; margin: 10px 0; box-sizing: border-box; }

        /* --- ESTILOS ARENA DE DUELOS --- */
        .arena-bg { background: #1a150f; color: #f4e4bc; padding: 30px; border-radius: 10px; border: 3px solid #d4af37; text-align: center; }
        .stage { display: flex; justify-content: space-around; align-items: center; margin: 20px 0; }
        .hp-bg { background: #444; height: 20px; width: 100%; border-radius: 10px; border: 1px solid gold; overflow: hidden; }
        .hp-fill { background: linear-gradient(90deg, #ff4b2b, #ff416c); height: 100%; width: 100%; transition: 0.5s; }
        .spell-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; }
        .spell-btn { background: #2c1e11; border: 1px solid #d4af37; color: #d4af37; padding: 15px; cursor: pointer; font-family: 'Cinzel'; }
        .spell-btn:hover { background: #d4af37; color: #1a150f; }
        #battle-log { height: 100px; overflow-y: auto; background: #000; padding: 10px; font-size: 13px; margin-top: 15px; text-align: left; border: 1px solid #5c4021; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>EL PROFETA REBELDE</h1>
        <div class="magic-nav">
            <button class="nav-btn active" onclick="verSeccion('noticias')">üóûÔ∏è NOTICIAS</button>
            <button class="nav-btn" onclick="verSeccion('arena')">‚öîÔ∏è DUELOS</button>
        </div>
    </header>

    <div id="sec-noticias" class="content-section active">
        <div id="lista-noticias">Cargando chismes...</div>
        
        <div class="formulario">
            <h3 style="font-family:'Cinzel'; color:gold;">üïµÔ∏è REDACTAR PRIMICIA</h3>
            <input type="text" id="autor" placeholder="Tu nombre o An√≥nimo">
            <input type="text" id="titulo" placeholder="T√≠tulo del chisme">
            <textarea id="texto" rows="4" placeholder="¬øQu√© pas√≥?"></textarea>
            <select id="casa">
                <option value="General">General</option>
                <option value="Slytherin">Slytherin üêç</option>
                <option value="Gryffindor">Gryffindor ü¶Å</option>
                <option value="Hufflepuff">Hufflepuff ü¶°</option>
                <option value="Ravenclaw">Ravenclaw ü¶Ö</option>
            </select>
            <button class="nav-btn" style="width:100%" onclick="publicar()">PUBLICAR EN EL PROFETA ‚ú®</button>
        </div>
    </div>

    <div id="sec-arena" class="content-section">
        <div class="arena-bg">
            <h2 style="font-family:'Cinzel'; color:gold;">CLUB DE DUELOS</h2>
            <div class="stage">
                <div style="width:40%">
                    <small>T√ö</small>
                    <div class="hp-bg"><div id="hp-p" class="hp-fill"></div></div>
                </div>
                <div style="font-family:'Cinzel'; color:gold;">VS</div>
                <div style="width:40%">
                    <small>RIVAL</small>
                    <div class="hp-bg"><div id="hp-e" class="hp-fill"></div></div>
                </div>
            </div>

            <div id="menu-duelo">
                <div class="spell-grid">
                    <button class="spell-btn" onclick="atacar('Expelliarmus', 15, 25)">‚ö° EXPELLIARMUS</button>
                    <button class="spell-btn" onclick="atacar('Desmaius', 20, 30)">üí´ DESMAIUS</button>
                    <button class="spell-btn" onclick="atacar('Rictusempra', 10, 35)">üòÇ RICTUSEMPRA</button>
                    <button class="spell-btn" onclick="atacar('Sectumsempra', 25, 45)">ü©∏ SECTUMSEMPRA</button>
                </div>
            </div>
            <div id="battle-log">Varitas arriba... ¬°Duelo!</div>
            <button id="btn-restart" class="nav-btn" style="display:none; margin-top:20px;" onclick="location.reload()">REINTENTAR üîÑ</button>
        </div>
    </div>
</div>

<audio id="snd-spell" src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3"></audio>
<audio id="snd-hit" src="https://assets.mixkit.co/active_storage/sfx/1655/1655-preview.mp3"></audio>

<script>
    // --- CONFIGURACI√ìN FIREBASE ---
    const DB_URL = "https://profeta-9c8df-default-rtdb.firebaseio.com/periodico";

    // --- NAVEGACI√ìN ---
    function verSeccion(sec) {
        document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById('sec-' + sec).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    // --- L√ìGICA PERI√ìDICO ---
    function publicar() {
        const id = Date.now();
        const data = {
            id,
            autor: document.getElementById('autor').value || "An√≥nimo",
            titulo: document.getElementById('titulo').value,
            texto: document.getElementById('texto').value,
            casa: document.getElementById('casa').value,
            votos: 0
        };
        fetch(`${DB_URL}/${id}.json`, { method: 'PUT', body: JSON.stringify(data) }).then(() => location.reload());
    }

    function cargarNoticias() {
        fetch(`${DB_URL}.json`).then(r => r.json()).then(data => {
            if(!data) return;
            const lista = Object.values(data).reverse();
            document.getElementById('lista-noticias').innerHTML = lista.map(n => `
                <div class="noticia">
                    <span class="casa-tag ${n.casa}">${n.casa}</span>
                    <h3>${n.titulo}</h3>
                    <p>${n.texto}</p>
                    <small>Por: ${n.autor}</small>
                </div>
            `).join('');
        });
    }

    // --- L√ìGICA ARENA (CORREGIDA) ---
    let hpP = 100, hpE = 100, bloqueado = false;

    function atacar(hechizo, min, max) {
        if(bloqueado || hpP <= 0 || hpE <= 0) return;
        bloqueado = true;
        
        document.getElementById('snd-spell').play();
        let da√±o = Math.floor(Math.random() * (max - min + 1)) + min;
        hpE -= da√±o;
        logMsg(`ü™Ñ Lanzaste <b>${hechizo}</b>. Da√±o: ${da√±o}`);
        actualizarBarras();

        if(hpE <= 0) return finalizar("¬°GANASTE EL DUELO! üèÜ");

        setTimeout(() => {
            document.getElementById('snd-hit').play();
            let da√±oE = 15;
            hpP -= da√±oE;
            logMsg(`üî• El rival responde. Pierdes ${da√±oE} PV.`);
            actualizarBarras();
            if(hpP <= 0) finalizar("HAS CA√çDO... üíÄ");
            bloqueado = false;
        }, 1000);
    }

    function actualizarBarras() {
        document.getElementById('hp-p').style.width = Math.max(0, hpP) + "%";
        document.getElementById('hp-e').style.width = Math.max(0, hpE) + "%";
    }

    function logMsg(m) {
        const l = document.getElementById('battle-log');
        l.innerHTML = `<div>${m}</div>` + l.innerHTML;
    }

    function finalizar(m) {
        logMsg(`<h2>${m}</h2>`);
        document.getElementById('menu-duelo').style.display = 'none';
        document.getElementById('btn-restart').style.display = 'block';
    }

    window.onload = cargarNoticias;
</script>

</body>
</html>
